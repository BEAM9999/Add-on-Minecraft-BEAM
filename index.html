<!DOCTYPE html>
<html lang="th">
<head>
  <link rel="icon" href="favicon-96x96.png">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ดาวน์โหลด Add-on Minecraft</title>
  <style>
    body {
      background: #181818;
      color: #eee;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      background: #222;
      padding: 20px;
      text-align: center;
      font-size: 2em;
      font-weight: bold;
      letter-spacing: 2px;
      color: #ffb300;
    }
    .search-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 30px 0 10px 0;
    }
    .search-bar input {
      width: 300px;
      padding: 10px;
      border-radius: 25px 0 0 25px;
      border: none;
      background: #333;
      color: #fff;
      font-size: 1em;
      outline: none;
    }
    .search-bar button {
      padding: 10px 18px;
      border-radius: 0 25px 25px 0;
      border: none;
      background: #444;
      color: #ffb300;
      cursor: pointer;
      font-size: 1em;
    }
    .addon-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin: 30px 0;
    }
    .addon-card {
      background: #232323;
      border-radius: 12px;
      box-shadow: 0 2px 8px #0006;
      width: 320px;
      padding: 18px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.2s;
      cursor: pointer;
    }
    .addon-card:hover {
      box-shadow: 0 4px 16px #000a;
    }
    .addon-img {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 12px;
      background: #444;
    }
    .addon-title {
      font-size: 1.2em;
      font-weight: bold;
      margin-bottom: 8px;
      color: #ffb300;
      text-align: center;
    }
    .addon-desc {
      font-size: 1em;
      margin-bottom: 12px;
      text-align: center;
      color: #ccc;
    }
    .addon-download {
      background: #ffb300;
      color: #222;
      border: none;
      border-radius: 6px;
      padding: 8px 20px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 6px;
    }
    .admin-btn {
      background: #00c853;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 20px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      margin-top: 18px;
      display: none;
    }
    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: #000a;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .modal-content {
      background: #232323;
      border-radius: 12px;
      padding: 30px;
      min-width: 350px;
      max-width: 90vw;
      max-height: 80vh;
      overflow-y: auto;
      color: #fff;
      box-shadow: 0 2px 16px #000a;
      position: relative;
      opacity: 1;
      transform: scale(1) translateY(0);
      transition: opacity 0.25s, transform 0.25s;
    }
    .modal-content.show-anim {
      animation: modalPopInWin 0.38s cubic-bezier(.25,1.5,.5,1) 1;
    }
    .modal-content.hide-anim {
      animation: modalMinimizeWin 0.32s cubic-bezier(.5,0,1,1) 1;
    }
      /* อนิเมชั่นเด้ง modal รายละเอียด Add-on จากปุ่มที่กด */
      .modal-content.detail-show-anim {
        animation: detailModalPopIn 0.38s cubic-bezier(.25,1.5,.5,1) 1;
      }
      @keyframes detailModalPopIn {
        0% {
          opacity: 0;
          transform: scale(0.7) translate(var(--detail-x,0), var(--detail-y,0));
        }
        60% {
          opacity: 1;
          transform: scale(1.05) translate(0, -12px);
        }
        100% {
          opacity: 1;
          transform: scale(1) translate(0, 0);
        }
      }
      /* อนิเมชั่นเด้ง modal จากตำแหน่งปุ่มไอคอน */
      .modal-content.yt-show-anim {
        animation: ytModalPopIn 0.38s cubic-bezier(.25,1.5,.5,1) 1;
      }
      .modal-content.yt-hide-anim {
        animation: ytModalMinimize 0.32s cubic-bezier(.5,0,1,1) 1;
      }
      @keyframes ytModalPopIn {
        0% {
          opacity: 0;
          transform: scale(0.7) translate(var(--yt-x,0), var(--yt-y,0));
        }
        60% {
          opacity: 1;
          transform: scale(1.05) translate(0, -12px);
        }
        100% {
          opacity: 1;
          transform: scale(1) translate(0, 0);
        }
      }
      @keyframes ytModalMinimize {
        0% {
          opacity: 1;
          transform: scale(1) translate(0, 0);
        }
        100% {
          opacity: 0;
          transform: scale(1) translate(0, 0);
        }
      }
    @keyframes modalPopInWin {
      0% {
        opacity: 0;
        transform: scale(0.7) translateY(120px);
      }
      60% {
        opacity: 1;
        transform: scale(1.05) translateY(-12px);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
    @keyframes modalMinimizeWin {
      0% {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
      80% {
        opacity: 0.7;
        transform: scale(0.7) translateY(120px);
      }
      100% {
        opacity: 0;
        transform: scale(0.5) translateY(180px);
      }
    }
    .close-btn {
  position: sticky;
  top: 0;
  right: 0;
  float: right;
  margin-top: -8px;
  margin-right: -0px;
  background: #ff1744;
  color: #fff;
  border: none;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  font-size: 1.2em;
  cursor: pointer;
  z-index: 10;
    }
    .addon-versions {
      margin-top: 18px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .version-btn {
      background: #ffb300;
      color: #222;
      border: none;
      border-radius: 6px;
      padding: 8px 20px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
    }
    .add-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 18px;
    }
    .add-form input, .add-form textarea {
      background: #333;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px;
      font-size: 1em;
    }
    .add-form label {
      color: #ffb300;
      font-weight: bold;
    }
    .add-form .add-version-btn {
      background: #00c853;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 20px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      margin-top: 8px;
    }
    .add-form .submit-btn {
      background: #ffb300;
      color: #222;
      border: none;
      border-radius: 6px;
      padding: 8px 20px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      margin-top: 12px;
    }
  </style>
</head>
<body>
  <!-- Modal แจ้งเตือนทรัพย์สินทางปัญญา -->
  <div class="modal" id="ipModal" style="display:none;z-index:2000;">
    <div class="modal-content" style="min-width:320px;max-width:95vw;text-align:center;">
      <div style="font-size:1.2em;font-weight:bold;color:#ffb300;margin-bottom:18px;">กรุณาเคารพทรัพย์สินทางปัญญาของผู้อื่น</div>
      <div style="color:#fff;margin-bottom:18px;">ห้ามคัดลอกหรือดูดข้อมูลจากเว็บไซต์นี้โดยไม่ได้รับอนุญาต</div>
      <button onclick="closeIpModal()" style="background:#ffb300;color:#222;border:none;border-radius:6px;padding:8px 32px;font-size:1.1em;font-weight:bold;cursor:pointer;">รับทราบ</button>
    </div>
  </div>
  <header style="display:flex;align-items:center;justify-content:center;gap:18px;">
    <img id="siteLogo" src="https://yt3.googleusercontent.com/ZlpQ7tdER2Gs-vWQ4OfRQaVCxaB1cakpwc4ZyX_p3fJtqsWJ-_HdZd6D9sk3W_RdsaOzZQ67xMA=s72-c-k-c0x00ffffff-no-rj" alt="โลโก้เว็บไซต์" style="width:48px;height:48px;border-radius:50px;object-fit:cover;cursor:pointer;">
    <span style="position:relative; top:-5px;">Add-on Minecraft</span>
  </header>
  <!-- Modal YouTube Channel Selector -->
  <div class="modal" id="ytModal" style="display:none">
    <div class="modal-content" style="min-width:320px;max-width:95vw;text-align:center;">
      <button class="close-btn" onclick="closeYtModal()">×</button>
      <div style="font-size:1.2em;font-weight:bold;color:#ffb300;margin-bottom:18px;">ช่อง YouTube ผู้สร้างเว็บไซต์</div>
      <div style="display:flex;justify-content:center;gap:32px;">
        <button onclick="window.open('https://www.youtube.com/@C2manga/videos','_blank')" style="background:none;border:none;cursor:pointer;">
          <img src="https://yt3.googleusercontent.com/ZlpQ7tdER2Gs-vWQ4OfRQaVCxaB1cakpwc4ZyX_p3fJtqsWJ-_HdZd6D9sk3W_RdsaOzZQ67xMA=s72-c-k-c0x00ffffff-no-rj" alt="C2manga" style="width:64px;height:64px;border-radius:50px;object-fit:cover;box-shadow:0 2px 8px #0006;">
          <div style="margin-top:8px;color:#fff;font-weight:bold;">C2manga</div>
        </button>
        <button onclick="window.open('https://www.youtube.com/@C3Manga','_blank')" style="background:none;border:none;cursor:pointer;">
          <img src="https://yt3.googleusercontent.com/B5CW5SIcNIckA-nNW9WvKadamSKa0c1O6DYxcC5Scitv50KJj-kVInUViTfZmUX0Lwj76DAouA=s72-c-k-c0x00ffffff-no-rj" alt="C3Manga" style="width:64px;height:64px;border-radius:50px;object-fit:cover;box-shadow:0 2px 8px #0006;">
          <div style="margin-top:8px;color:#fff;font-weight:bold;">C3Manga</div>
        </button>
      </div>
    </div>
  </div>
  <div class="search-bar">
  <input type="text" id="searchInput" placeholder="ค้นหา Add-on..." onkeydown="if(event.key==='Enter'){searchAddons();}" onkeyup="searchAddons()">
  <button onclick="searchAddons()">🔍</button>
  </div>
  <button class="admin-btn" id="adminBtn" onclick="openAddModal()" style="position:fixed;top:5px;right:24px;z-index:1001;">+ เพิ่ม Add-on ใหม่</button>
  <button class="admin-btn" id="exportBtn" onclick="exportAddons()" style="position:fixed;top:50px;right:24px;z-index:1001;display:none;background:#1976d2;">Export Add-on</button>
  <button class="admin-btn" id="codeImportBtn" onclick="openCodeImportModal()" style="position:fixed;top:95px;right:24px;z-index:1001;display:none;background:#8e24aa;">+ เพิ่มด้วยโค้ด</button>
  <!-- Modal สำหรับ Import Add-on ด้วยโค้ด -->
  <div class="modal" id="codeImportModal" style="display:none">
    <div class="modal-content">
      <button class="close-btn" onclick="closeCodeImportModal()">×</button>
      <form class="add-form" id="codeImportForm">
        <label>วางโค้ด Add-on (Array หรือ Object)</label>
        <textarea id="codeImportTextarea" rows="10" style="font-family:monospace;"></textarea>
        <button type="submit" class="submit-btn">เพิ่ม Add-on จากโค้ด</button>
      </form>
    </div>
  </div>

  <div class="addon-list" id="addonList"></div>

  <!-- Modal สำหรับแก้ไข Add-on -->
  <div class="modal" id="editModal" style="display:none">
    <div class="modal-content">
  <button class="close-btn" onclick="closeEditModal()">×</button>
  <button id="deleteAddonBtn" style="position:absolute;top:12px;left:18px;background:#ff1744;color:#fff;border:none;border-radius:6px;padding:6px 18px;font-size:1em;font-weight:bold;cursor:pointer;z-index:2;" onclick="deleteAddon()">ลบ</button>
  <form class="add-form" id="editForm">
        <label>ชื่อ Add-on</label>
        <input type="text" id="editTitle">
        <label>คำอธิบาย</label>
        <textarea id="editDesc" rows="3"></textarea>
        <label>ลิงก์รูปภาพ (URL)</label>
        <input type="text" id="editImg">
        <label>เวอร์ชั่น Minecraft (เพิ่มหลายเวอร์ชั่นได้)</label>
        <div id="editVersionFields"></div>
        <button type="button" class="add-version-btn" onclick="addEditVersionField()">+ เพิ่มเวอร์ชั่น</button>
        <button type="submit" class="submit-btn">บันทึกการแก้ไข</button>
      </form>
    </div>
  </div>

  <!-- Modal สำหรับรายละเอียด Add-on -->
  <div class="modal" id="detailModal" style="display:none">
    <div class="modal-content" id="modalContent"></div>
  </div>

  <!-- Modal สำหรับเพิ่ม Add-on -->
  <div class="modal" id="addModal" style="display:none">
    <div class="modal-content">
      <button class="close-btn" onclick="closeAddModal()">×</button>
      <form class="add-form" id="addForm">
        <label>ชื่อ Add-on</label>
        <input type="text" id="newTitle">
        <label>คำอธิบาย</label>
        <textarea id="newDesc" rows="3"></textarea>
        <label>ลิงก์รูปภาพ (URL)</label>
        <input type="text" id="newImg">
        <label>เวอร์ชั่น Minecraft (เพิ่มหลายเวอร์ชั่นได้)</label>
        <div id="versionFields"></div>
        <button type="button" class="add-version-btn" onclick="addVersionField()">+ เพิ่มเวอร์ชั่น</button>
        <button type="submit" class="submit-btn">บันทึก Add-on</button>
      </form>
    </div>
  </div>

  <script>
// ป้องกันการเปิด DevTools และแจ้งเตือนทรัพย์สินทางปัญญา
function showIpModal() {
  document.getElementById('ipModal').style.display = 'flex';
}
function closeIpModal() {
  document.getElementById('ipModal').style.display = 'none';
}
document.addEventListener('contextmenu', function(e) {
  e.preventDefault();
});
document.addEventListener('keydown', function(e) {
  // F12
  if (e.key === 'F12') {
    e.preventDefault();
    showIpModal();
    return false;
  }
  // Ctrl+Shift+I หรือ Ctrl+Shift+J
  if ((e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) ||
      (e.ctrlKey && e.key === 'U')) {
    e.preventDefault();
    showIpModal();
    return false;
  }
});
// ตรวจจับ DevTools ถูกเปิด (แบบง่าย)
let devtoolsOpen = false;
setInterval(function() {
  const threshold = 160;
  if (window.outerWidth - window.innerWidth > threshold || window.outerHeight - window.innerHeight > threshold) {
    if (!devtoolsOpen) {
      devtoolsOpen = true;
      showIpModal();
    }
  } else {
    devtoolsOpen = false;
  }
}, 1000);

let addons = [
  {
    "title": "C2 The World v.1.1.1",
    "desc": "—---------------------------\nแอดออนนี้ มีชื่อว่า C2 the world \nผู้สร้าง C2มังงะ \nช่อง YouTube  C2มังงะ\n—---------------------------\n\nเมื่อคุณลงแอดออนแล้วคุณจะเห็นไอเทมขึ้นมาทันทีเมื่อคุณสร้างโลก\nhttps://media.discordapp.net/attachments/1429104419232022740/1429183309468139650/image.png?ex=68f5362d&is=68f3e4ad&hm=36c84c945491d7ffc8c7d455b0eafa2fe8f7aaa1248442bfff01831733c7d2a9&=&format=webp&quality=lossless&width=1617&height=856\n\n1. ความสามารถอย่างที่ 1\nบันทึกจุดวาร์ปของเราได้ว่าเราจะวาร์ปไปจุดไหนที่เราบันทึกไว้\nhttps://cdn.discordapp.com/attachments/1429104419232022740/1429183451667370055/image.png?ex=68f5364f&is=68f3e4cf&hm=c55c2f6756514446b464ffd1314981e4a4eac38ee44d740a3972732046235cf0\n\n2.ความสามารถอย่างที่ 2\nตลาด Safe Zone เราสามารถวาร์ปมาจุดนี้ได้ก็ต่อเมื่อเจ้าของแอดออนหรือผู้เป็นแอดมินตั้ง\nค่าไว้ \nhttps://media.discordapp.net/attachments/1429104419232022740/1429183742093820095/image.png?ex=68f53695&is=68f3e515&hm=eeb8e6e5aaabd24e1218c007bec1bc9940db61a2c82c51fab5cafce445703f0a&=&format=webp&quality=lossless&width=1645&height=856\n\n3.ความสามารถอย่างที่ 3\nโหมดทำฟาร์มเมื่อเราพรั่วดินที่จะทำฟาร์มเสร็จแล้วคุณสามารถถือเมล็ดพันธุ์ข้าวหรือเมล็ด\nพันธุ์อื่นโดยการกดย่อตัวแล้วกดปลูกมันก็จะปลูกให้ทั้งแปลงเลยทีเดียว\nแล้วก็ตอนคุณจะเก็บเกี่ยวคุณก็กดย่อแล้วก็กดทุบมันก็จะเก็บให้เลยทีเดียวเหมือนกัน\nแต่คุณต้องถือเมล็ดหรือถือข้าวในมือเพราะว่าจุดนี้มันยังบัคอยู่เมล็ดอะไรก็ได้\nแม้แต่ต้นอ่อนของต้นไม้\nhttps://cdn.discordapp.com/attachments/1429104419232022740/1429184127789301850/image.png?ex=68f536f1&is=68f3e571&hm=6a3cb02e1939be59f446a698b4526f2552a114576141ea7588393dce494b8c81\nhttps://cdn.discordapp.com/attachments/1429104419232022740/1429184127789301850/image.png?ex=68f536f1&is=68f3e571&hm=6a3cb02e1939be59f446a698b4526f2552a114576141ea7588393dce494b8c81\n\n4.ความสามารถอย่างที่ 4\nเมนูคนงานฟังก์ชันนี้แต่ละปุ่มขุดแร่ตัดต้นไม้ไม่สามารถใช้ได้ตลอดจะนับเวลาคูลดาวน์\nเพื่อไม่ให้มันโกงเกินไปสำหรับแอดออนนี้เพื่อให้การเล่นเกมท้าทายยิ่งขึ้นจะได้ไม่เบื่อ\nแต่เราสามารถเติมเวลาได้ด้วยการใช้ เพชรทอง:มรกต:ทอง:เหล็ก:แท่งเนเธอไรต์\nจำนวนใส่เท่าไหร่ก็ได้ทีละ 1 ก็ได้ \nhttps://media.discordapp.net/attachments/1429104419232022740/1429185082471481475/2025-10-19_021014.png?ex=68f537d4&is=68f3e654&hm=856b64d113799be96d7f9a7795e3e9c5601056fd162b2e9216c07d18ffa445f3&=&format=webp&quality=lossless&width=1620&height=856\nhttps://media.discordapp.net/attachments/1429104419232022740/1429184980310954267/image.png?ex=68f537bc&is=68f3e63c&hm=a7a43d15036dd0bae2f44becb70712d1fc475fc8c31f19a5560335873b321d70&=&format=webp&quality=lossless&width=1644&height=856\n\n5.ความสามารถอย่างที่ 5\nโหมดต่อสู้มีคูลดาวน์เหมือนกัน โหมดนี้มีแค่ความสามารถเดียวเนื่องจากยังไม่ได้อัพเดท\nความสามารถคือตกจากที่สูงไม่ตายไม่มีอะไรทำร้ายตายได้แต่จะมีคูลดาวน์เหมือนกัน\nเพื่อไม่ให้มันโกงเกินไปจนไม่น่าเล่น สามารถเพิ่มเวลาได้โดยใช้ เพชรทอง:มรกต:ทอง:เหล็ก:แท่งเนเธอไรต์\nจำนวนใส่เท่าไหร่ก็ได้ทีละ 1 ก็ได้ \nhttps://cdn.discordapp.com/attachments/1429104419232022740/1429185305595875398/image.png?ex=68f53809&is=68f3e689&hm=e2fafd3e465840e9493651595f66c0fb95461d79aa3300a142cfdfaf481a51d0\n\n6.ความสามารถอย่างที่ 6\nโหมด Admin โหมดนี้เป็นโหมดหลังบ้านเกี่ยวกับหลังบ้านทั้งหมดเลย\nใช้เฉพาะเจ้าของโรคที่รู้รหัสแอดมิน \nรหัสแอดมินคือ : 111 :\nhttps://media.discordapp.net/attachments/1429104419232022740/1429462718053613588/image.png?ex=68f63a66&is=68f4e8e6&hm=3630be80c8a6f8bce6097faebd3c2529d215f1beab9556fa95e6cb500124308c&=&format=webp&quality=lossless&width=1654&height=856\n\n7.ความสามารถอย่างที่ 7\nความสามารถนี้เมื่อเปิดแล้วจะสามารถดูชื่อบล็อก\nหรือชื่อสิ่งมีชีวิตทุกตัวได้ พร้อมกับดูหลอดเลือด\n‼️แต่ความสามารถนี้อาจจะบัคถ้ามีแอดออนภาษาไทยเข้าร่วมด้วย‼️\nจะบัคเฉพาะการดูหลอดเลือด \nแนะนำให้ติดตามช่อง : C3 มังงะ : หรือ : C2 มังงะ\nเพื่อดูวิธีการใช้ Add On ภาษาไทยร่วมด้วยเพื่อไม่ให้มันบัค\nhttps://media.discordapp.net/attachments/1429104419232022740/1429185407739760803/image.png?ex=68f5e0e2&is=68f48f62&hm=404130c13aab7cfd0d99dabd94ff5a4dd3b49d846684100b199aa7933afb30ec&=&format=webp&quality=lossless&width=1622&height=856",
    "img": "https://cdn.discordapp.com/attachments/1429104419232022740/1429104567995465728/pack_icon-removebg-preview.png?ex=68f4ecd8&is=68f39b58&hm=719e792efeceef8d430c440ff4c5d76d15469ef909fc4cd39d72cc18dbbcc25a",
    "versions": [
      {
        "name": "v 1.21.+",
        "link": "https://drive.usercontent.google.com/download?id=1VlxTORXj6WCA4xiBa5mw_xXyxy1NTFnC&export=download&authuser=1&confirm=t&uuid=33502b21-0473-4032-a3c2-21f7d6523a45&at=AKSUxGOJolcG9iw2tAChaf8xHl1_:1760792610124"
      }
    ]
  }
];
let isAdmin = false;


    function renderAddons(list) {
      const addonList = document.getElementById('addonList');
      addonList.innerHTML = '';
      list.forEach((addon, idx) => {
        const card = document.createElement('div');
        card.className = 'addon-card';
        card.onclick = () => openDetailModal(idx);
        let html = '';
        if (isAdmin) {
          html += `<button style='position:absolute;top:10px;right:10px;background:#1976d2;color:#fff;border:none;border-radius:6px;padding:4px 14px;font-size:1em;font-weight:bold;z-index:2;cursor:pointer;' onclick='event.stopPropagation(); openEditModal(${idx})'>แก้ไข</button>`;
        }
        html += `
          <img src="${addon.img || ''}" class="addon-img" alt="รูป Add-on">
          <div class="addon-title">${addon.title || ''}</div>
          <button class="addon-download" onclick="event.stopPropagation(); openDetailModal(${idx})">${(addon.versions && addon.versions.length > 0 && addon.versions[0].name) ? addon.versions[0].name : 'ดาวน์โหลด'}</button>
        `;
        card.innerHTML = html;
        if (isAdmin) card.style.position = 'relative';
        addonList.appendChild(card);
      });
    }

    function searchAddons() {
  let val = document.getElementById('searchInput').value.trim().toLowerCase();
  const valNoSpace = val.replace(/\s+/g, '');
      if (val === 'adminbeam') {
        isAdmin = true;
        document.getElementById('adminBtn').style.display = 'inline-block';
        document.getElementById('exportBtn').style.display = 'inline-block';
        document.getElementById('codeImportBtn').style.display = 'inline-block';
        renderAddons(addons);
        return;
      }
      const filtered = addons.filter(a => {
        // ค้นหาจากชื่อ Add-on, เวอร์ชั่น หรือคำอธิบาย (รองรับแบบไม่เว้นวรรคและตรวจจับข้อความในคำอธิบายละเอียดขึ้น)
        const title = (a.title || '').toLowerCase();
        const titleNoSpace = title.replace(/\s+/g, '');
        const desc = (a.desc || '').toLowerCase();
        const descNoSpace = desc.replace(/\s+/g, '');
        // ตรวจจับคำค้นหาในคำอธิบายทุกจุด
        const descMatch = desc.indexOf(val) !== -1 || descNoSpace.indexOf(valNoSpace) !== -1;
        const titleMatch = title.indexOf(val) !== -1 || titleNoSpace.indexOf(valNoSpace) !== -1;
        const versionMatch = Array.isArray(a.versions) && a.versions.some(v => {
          const verName = (v.name || '').toLowerCase();
          const verNameNoSpace = verName.replace(/\s+/g, '');
          return verName.indexOf(val) !== -1 || verNameNoSpace.indexOf(valNoSpace) !== -1;
        });
        return titleMatch || versionMatch || descMatch;
      });
      renderAddons(filtered);
    }
// Modal Import Add-on ด้วยโค้ด
function openCodeImportModal() {
  document.getElementById('codeImportModal').style.display = 'flex';
  document.getElementById('codeImportForm').reset();
  document.getElementById('codeImportTextarea').value = '';
}
function closeCodeImportModal() {
  document.getElementById('codeImportModal').style.display = 'none';
}
document.getElementById('codeImportForm').onsubmit = function(e) {
  e.preventDefault();
  let code = document.getElementById('codeImportTextarea').value.trim();
  if (!code) return alert('กรุณาวางโค้ดก่อน');
  try {
    let validAddons = [];
    // 1. พยายาม parse เป็น JSON ก่อน (รองรับ addons.json)
    try {
      let parsed = JSON.parse(code);
      if (!Array.isArray(parsed)) parsed = [parsed];
      for (let obj of parsed) {
        if (typeof obj === 'object' && (obj.title || obj.desc || obj.img || obj.versions)) {
          let versions = Array.isArray(obj.versions) ? obj.versions.filter(v => v.name && v.link) : [];
          validAddons.push({
            title: obj.title || '',
            desc: obj.desc || '',
            img: obj.img || '',
            versions: versions
          });
        }
      }
    } catch (jsonErr) {
      // ถ้าไม่ใช่ JSON หรือ JSON ไม่สมบูรณ์ ให้ใช้ regex ดึงเฉพาะ properties ที่จำเป็น
      let title = code.match(/"?title"?\s*:\s*(["'])(.*?)\1/);
      let desc = code.match(/"?desc"?\s*:\s*(["'])(.*?)\1/);
      let img = code.match(/"?img"?\s*:\s*(["'])(.*?)\1/);
      // หา versions block (อาจไม่ปิด ] ก็ได้)
      let versionsBlock = code.match(/"?versions"?\s*:\s*\[((?:.|\n)*?)(?:\]|$)/);
      let versions = [];
      if (versionsBlock && versionsBlock[1]) {
        let versionRegex = /\{[^\}]*?"?name"?\s*:\s*(["'])(.*?)\1\s*,\s*"?link"?\s*:\s*(["'])(.*?)\3[^\}]*?\}/g;
        let m;
        while ((m = versionRegex.exec(versionsBlock[1])) !== null) {
          versions.push({ name: m[2], link: m[4] });
        }
      }
      if (!title && !desc && !img && versions.length === 0) throw new Error('ไม่พบข้อมูล Add-on ที่ถูกต้อง');
      let addon = {
        title: title ? title[2] : '',
        desc: desc ? desc[2] : '',
        img: img ? img[2] : '',
        versions: versions
      };
      validAddons.push(addon);
    }
    if (validAddons.length === 0) throw new Error('ไม่พบข้อมูล Add-on ที่ถูกต้อง');

  addons = addons.concat(validAddons);
    closeCodeImportModal();
    renderAddons(addons);
    saveAddons();
  } catch (err) {
    alert('โค้ดไม่ถูกต้อง: ' + err.message);
  }
};

    function openDetailModal(idx) {
      const addon = addons[idx];
      const modal = document.getElementById('detailModal');
      const content = document.getElementById('modalContent');
      let html = `<button class='close-btn' onclick='closeDetailModal()'>×</button>`;
      html += `<img src='${addon.img}' class='addon-img' style='margin-bottom:18px;'>`;
      html += `<div class='addon-title'>${addon.title}</div>`;
      // สร้าง descHtml โดยแทนที่ลิงก์รูปภาพและลิงก์ YouTube ด้วยปุ่มแยกแต่ละจุด
      let descHtml = (addon.desc||'')
        // ปุ่มแสดงรูปภาพ
        .replace(/(https?:\/\/(?:[^\s"'\n\r]+?\.(?:png|jpg|jpeg|gif|webp|bmp|svg)(?:\?[^\s"'\n\r]*)?))/gi, function(url) {
          return `<button class="desc-img-btn" data-img-url="${url}" style="background:#444;color:#00c853;border:none;border-radius:6px;padding:2px 12px;margin:4px 0;cursor:pointer;">แสดงรูปภาพ</button>`;
        })
        // ปุ่มแสดงคลิป YouTube
        .replace(/(https?:\/\/(?:www\.|m\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_-]{11}))/gi, function(url, full, vid) {
          return `<button class="desc-yt-btn" data-yt-url="${url}" data-yt-id="${vid}" style="background:#222;color:#ff1744;border:none;border-radius:6px;padding:2px 12px;margin:4px 0;cursor:pointer;">แสดงคลิป YouTube</button>`;
        })
        .replace(/\\n/g, '<br>')
        .replace(/\r\n|\r|\n/g, '<br>');
      html += `<div class='addon-desc' id='addonDescArea'>${descHtml}</div>`;
      html += `<div class='addon-versions'>`;
      addon.versions.forEach(ver => {
        html += `<button class='version-btn' onclick="window.open('${ver.link}','_blank')">ดาวน์โหลดเวอร์ชั่น ${ver.name}</button>`;
      });
      html += `</div>`;
      content.innerHTML = html;
      // ฟีเจอร์แสดง/ซ่อนรูปภาพและคลิป YouTube แบบแยกปุ่ม
      const descArea = document.getElementById('addonDescArea');
      // รูปภาพ
      descArea.querySelectorAll('.desc-img-btn').forEach(btn => {
        btn.onclick = function() {
          if (btn.dataset.shown === '1') {
            if (btn.nextSibling && btn.nextSibling.className === 'desc-img-container') {
              btn.nextSibling.remove();
            }
            btn.innerHTML = 'แสดงรูปภาพ';
            btn.dataset.shown = '';
            btn.style.display = '';
          } else {
            const container = document.createElement('div');
            container.className = 'desc-img-container';
            container.style.display = 'flex';
            container.style.flexDirection = 'column';
            container.style.alignItems = 'center';
            container.style.justifyContent = 'center';
            container.style.margin = '8px 0';
            const img = document.createElement('img');
            img.src = btn.getAttribute('data-img-url');
            img.style.maxWidth = '400px';
            img.style.width = '100%';
            img.style.height = 'auto';
            img.style.maxHeight = '250px';
            img.style.borderRadius = '8px';
            img.style.boxShadow = '0 2px 8px #0006';
            img.className = 'desc-img-preview';
            // ฟีเจอร์ขยายรูปภาพเต็มหน้าจอ
            img.style.cursor = 'zoom-in';
            img.onclick = function(e) {
              e.stopPropagation();
              // สร้าง modal เต็มจอ
              const fullscreenModal = document.createElement('div');
              fullscreenModal.className = 'img-fullscreen-modal';
              fullscreenModal.style.position = 'fixed';
              fullscreenModal.style.top = '0';
              fullscreenModal.style.left = '0';
              fullscreenModal.style.width = '100vw';
              fullscreenModal.style.height = '100vh';
              fullscreenModal.style.background = 'rgba(0,0,0,0.95)';
              fullscreenModal.style.display = 'flex';
              fullscreenModal.style.alignItems = 'center';
              fullscreenModal.style.justifyContent = 'center';
              fullscreenModal.style.zIndex = '99999';
              fullscreenModal.style.cursor = 'zoom-out';
              // รูปภาพใหญ่
              const bigImg = document.createElement('img');
              bigImg.src = img.src;
              bigImg.style.maxWidth = '96vw';
              bigImg.style.maxHeight = '96vh';
              bigImg.style.borderRadius = '12px';
              bigImg.style.boxShadow = '0 4px 32px #000a';
              bigImg.style.background = '#222';
              bigImg.style.cursor = 'zoom-out';
              fullscreenModal.appendChild(bigImg);
              // ปิด modal เมื่อคลิกพื้นที่ว่างเท่านั้น (ไม่รองรับปุ่ม Back)
              function closeFullscreen() {
                document.body.removeChild(fullscreenModal);
              }
              fullscreenModal.onclick = function(e) {
                if (e.target === fullscreenModal) closeFullscreen();
              };
              document.body.appendChild(fullscreenModal);
            };
            const hideBtn = document.createElement('button');
            hideBtn.textContent = 'ซ่อนรูปภาพ';
            hideBtn.style.background = '#444';
            hideBtn.style.color = '#ff1744';
            hideBtn.style.border = 'none';
            hideBtn.style.borderRadius = '6px';
            hideBtn.style.padding = '2px 12px';
            hideBtn.style.margin = '12px 0 0 0';
            hideBtn.style.cursor = 'pointer';
            hideBtn.style.display = 'block';
            hideBtn.style.fontSize = '1em';
            hideBtn.onclick = function() {
              container.remove();
              btn.innerHTML = 'แสดงรูปภาพ';
              btn.dataset.shown = '';
              btn.style.display = '';
            };
            container.appendChild(img);
            container.appendChild(hideBtn);
            btn.parentNode.insertBefore(container, btn.nextSibling);
            btn.innerHTML = '';
            btn.dataset.shown = '1';
            btn.style.display = 'none';
          }
        };
      });
      // คลิป YouTube
      descArea.querySelectorAll('.desc-yt-btn').forEach(btn => {
        btn.onclick = function() {
          if (btn.dataset.shown === '1') {
            if (btn.nextSibling && btn.nextSibling.className === 'desc-yt-container') {
              btn.nextSibling.remove();
            }
            btn.innerHTML = 'แสดงคลิป YouTube';
            btn.dataset.shown = '';
            btn.style.display = '';
          } else {
            const container = document.createElement('div');
            container.className = 'desc-yt-container';
            container.style.display = 'flex';
            container.style.flexDirection = 'column';
            container.style.alignItems = 'center';
            container.style.justifyContent = 'center';
            container.style.margin = '8px 0';
            // iframe YouTube
            const ytId = btn.getAttribute('data-yt-id');
            const iframe = document.createElement('iframe');
            iframe.src = `https://www.youtube.com/embed/${ytId}`;
            iframe.width = '400';
            iframe.height = '225';
            iframe.style.maxWidth = '100%';
            iframe.style.borderRadius = '8px';
            iframe.style.boxShadow = '0 2px 8px #0006';
            iframe.setAttribute('allowfullscreen', '');
            iframe.setAttribute('frameborder', '0');
            iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
            // ปุ่มซ่อนคลิป
            const hideBtn = document.createElement('button');
            hideBtn.textContent = 'ซ่อนคลิป YouTube';
            hideBtn.style.background = '#222';
            hideBtn.style.color = '#ff1744';
            hideBtn.style.border = 'none';
            hideBtn.style.borderRadius = '6px';
            hideBtn.style.padding = '2px 12px';
            hideBtn.style.margin = '12px 0 0 0';
            hideBtn.style.cursor = 'pointer';
            hideBtn.style.display = 'block';
            hideBtn.style.fontSize = '1em';
            hideBtn.onclick = function() {
              container.remove();
              btn.innerHTML = 'แสดงคลิป YouTube';
              btn.dataset.shown = '';
              btn.style.display = '';
            };
            container.appendChild(iframe);
            container.appendChild(hideBtn);
            btn.parentNode.insertBefore(container, btn.nextSibling);
            btn.innerHTML = '';
            btn.dataset.shown = '1';
            btn.style.display = 'none';
          }
        };
      });
      // --- อนิเมชั่นเด้ง modal จากปุ่มที่กด ---
      // หาตำแหน่งปุ่มที่กด (addon-card)
      const cards = document.querySelectorAll('.addon-card');
      let cardRect = null;
      if (cards[idx]) cardRect = cards[idx].getBoundingClientRect();
      const centerX = window.innerWidth/2;
      const centerY = window.innerHeight/2;
      let cardX = centerX, cardY = centerY;
      if (cardRect) {
        cardX = cardRect.left + cardRect.width/2;
        cardY = cardRect.top + cardRect.height/2;
      }
      const dx = cardX - centerX;
      const dy = cardY - centerY;
      content.style.setProperty('--detail-x', dx+'px');
      content.style.setProperty('--detail-y', dy+'px');
      modal.style.display = 'flex';
      setTimeout(function() {
        content.classList.remove('hide-anim');
        content.classList.add('detail-show-anim');
      }, 10);
      // History API: push state for modal
      if (!window._addonModalOpen) {
        window.history.pushState({modal:'detail'}, '', window.location.href);
        window._addonModalOpen = true;
      }
    }
    function closeDetailModal() {
      var modal = document.getElementById('detailModal');
      var content = document.getElementById('modalContent');
      content.classList.remove('detail-show-anim');
      content.classList.add('hide-anim');
      setTimeout(function() {
        modal.style.display = 'none';
        content.classList.remove('hide-anim');
      }, 300);
      if (window._addonModalOpen) {
        window._addonModalOpen = false;
        // Only go back if user pressed back, not programmatically
        if (window.history.state && window.history.state.modal === 'detail') {
          window.history.back();
        }
      }
    }
    // Listen for back button to close modal
    window.addEventListener('popstate', function(e) {
      if (window._addonModalOpen) {
        closeDetailModal();
      }
    });

    function openAddModal() {
      document.getElementById('addModal').style.display = 'flex';
    }
    function closeAddModal() {
      document.getElementById('addModal').style.display = 'none';
      document.getElementById('addForm').reset();
      document.getElementById('versionFields').innerHTML = '';
    }
    function addVersionField() {
      const div = document.createElement('div');
      div.style.display = 'flex';
      div.style.gap = '8px';
      div.style.marginTop = '8px';
      div.innerHTML = `<input type="text" placeholder="ชื่อเวอร์ชั่น เช่น 1.20.1" class="verName">
      <input type="text" placeholder="ลิงก์ดาวน์โหลด (Google Drive)" class="verLink">
      <button type="button" style="background:#ff1744;color:#fff;border:none;border-radius:6px;padding:0 10px;cursor:pointer;" onclick="this.parentNode.remove()">ลบ</button>`;
      document.getElementById('versionFields').appendChild(div);
    }
    // เริ่มต้นมี 1 แถวเมื่อเปิด modal เพิ่ม
    function openAddModal() {
      document.getElementById('addModal').style.display = 'flex';
      document.getElementById('addForm').reset();
      document.getElementById('versionFields').innerHTML = '';
      addVersionField();
    }
    document.getElementById('addForm').onsubmit = function(e) {
      e.preventDefault();
      const title = document.getElementById('newTitle').value.trim();
      const desc = document.getElementById('newDesc').value.trim();
      let img = document.getElementById('newImg').value.trim();
      if (typeof convertDriveImageUrl === 'function') {
        img = convertDriveImageUrl(img);
      }
      const verNames = Array.from(document.querySelectorAll('#versionFields .verName')).map(i => i.value.trim());
      const verLinks = Array.from(document.querySelectorAll('#versionFields .verLink')).map(i => i.value.trim());
      let versions = [];
      for (let i = 0; i < verNames.length; i++) {
        if (verNames[i] || verLinks[i]) {
          versions.push({ name: verNames[i], link: verLinks[i] });
        }
      }
      addons.push({ title, desc, img, versions });
      renderAddons(addons);
      closeAddModal();
      saveAddons();
    };

    // Modal แก้ไข Add-on
    let editIdx = null;
    function openEditModal(idx) {
      editIdx = idx;
      const addon = addons[idx];
      document.getElementById('editTitle').value = addon.title || '';
      document.getElementById('editDesc').value = addon.desc || '';
      document.getElementById('editImg').value = addon.img || '';
      const editFields = document.getElementById('editVersionFields');
      editFields.innerHTML = '';
      (addon.versions||[]).forEach(ver => {
        const div = document.createElement('div');
        div.style.display = 'flex';
        div.style.gap = '8px';
        div.style.marginTop = '8px';
        div.innerHTML = `<input type="text" placeholder="ชื่อเวอร์ชั่น เช่น 1.20.1" class="verName" value="${ver.name||''}">
        <input type="text" placeholder="ลิงก์ดาวน์โหลด (Google Drive)" class="verLink" value="${ver.link||''}">
        <button type="button" style="background:#ff1744;color:#fff;border:none;border-radius:6px;padding:0 10px;cursor:pointer;" onclick="this.parentNode.remove()">ลบ</button>`;
        editFields.appendChild(div);
      });
      if ((addon.versions||[]).length === 0) addEditVersionField();
      document.getElementById('editModal').style.display = 'flex';
    }
    function closeEditModal() {
      document.getElementById('editModal').style.display = 'none';
      editIdx = null;
    }
    function addEditVersionField() {
      const div = document.createElement('div');
      div.style.display = 'flex';
      div.style.gap = '8px';
      div.style.marginTop = '8px';
      div.innerHTML = `<input type="text" placeholder="ชื่อเวอร์ชั่น เช่น 1.20.1" class="verName">
      <input type="text" placeholder="ลิงก์ดาวน์โหลด (Google Drive)" class="verLink">
      <button type="button" style="background:#ff1744;color:#fff;border:none;border-radius:6px;padding:0 10px;cursor:pointer;" onclick="this.parentNode.remove()">ลบ</button>`;
      document.getElementById('editVersionFields').appendChild(div);
    }
    document.getElementById('editForm').onsubmit = function(e) {
      e.preventDefault();
      if (editIdx === null) return;
      const title = document.getElementById('editTitle').value.trim();
      const desc = document.getElementById('editDesc').value.trim();
      let img = document.getElementById('editImg').value.trim();
      if (typeof convertDriveImageUrl === 'function') {
        img = convertDriveImageUrl(img);
      }
      const verNames = Array.from(document.querySelectorAll('#editVersionFields .verName')).map(i => i.value.trim());
      const verLinks = Array.from(document.querySelectorAll('#editVersionFields .verLink')).map(i => i.value.trim());
      let versions = [];
      for (let i = 0; i < verNames.length; i++) {
        if (verNames[i] || verLinks[i]) {
          versions.push({ name: verNames[i], link: verLinks[i] });
        }
      }
      addons[editIdx] = { title, desc, img, versions };
      renderAddons(addons);
      closeEditModal();
      saveAddons();
    };

    // ฟังก์ชันลบ Add-on
function deleteAddon() {
  if (editIdx === null) return;
  addons.splice(editIdx, 1);
  closeEditModal();
  renderAddons(addons);
  saveAddons();
}

// ฟังก์ชัน Export Add-on
function exportAddons() {
  const jsStr =
    'let addons = ' + JSON.stringify(addons, null, 2) + ' \nlet isAdmin = false;\n';
  const blob = new Blob([jsStr], { type: 'text/javascript' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'addons.js';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// ฟังก์ชัน Save Add-on (เรียกใช้หลังเพิ่ม/แก้ไข/ลบ)
function saveAddons() {
  // ไม่บันทึกลง LocalStorage อีกต่อไป
}

// โหลดข้อมูล Add-on จากตัวแปร addons ที่ฝังในไฟล์เท่านั้น
window.onload = function() {
  renderAddons(addons);
}

    // Render ครั้งแรก
    renderAddons(addons);
  </script>
  <script>
document.addEventListener('DOMContentLoaded', function() {
  var siteLogo = document.getElementById('siteLogo');
  if (siteLogo) {
    siteLogo.onclick = openYtModal;
  }
});

// --- Modal YouTube เด้งจากตำแหน่งปุ่มไอคอน ---
let ytModalOpen = false;
function openYtModal() {
  // History API: push state สำหรับ modal YouTube
  if (!window._ytModalOpen) {
    window.history.pushState({modal:'yt'}, '', window.location.href);
    window._ytModalOpen = true;
  }
  if (ytModalOpen) return; // ป้องกันซ้อน
  ytModalOpen = true;
  const modal = document.getElementById('ytModal');
  const content = modal.querySelector('.modal-content');
  // คำนวณตำแหน่งปุ่มไอคอน
  const logo = document.getElementById('siteLogo');
  const rect = logo.getBoundingClientRect();
  // คำนวณ offset จากกลางหน้าจอ (modal-content จะอยู่กลางจอ)
  const centerX = window.innerWidth/2;
  const centerY = window.innerHeight/2;
  const iconX = rect.left + rect.width/2;
  const iconY = rect.top + rect.height/2;
  const dx = iconX - centerX;
  const dy = iconY - centerY;
  // set custom property
  content.style.setProperty('--yt-x', dx+'px');
  content.style.setProperty('--yt-y', dy+'px');
  // reset hide anim
  content.classList.remove('yt-hide-anim');
  // show modal
  modal.style.display = 'flex';
  setTimeout(function() {
    content.classList.add('yt-show-anim');
  }, 10);
}
function closeYtModal() {
  if (window._ytModalOpen) {
    window._ytModalOpen = false;
    // Only go back if user pressed back, not programmatically
    if (window.history.state && window.history.state.modal === 'yt') {
      window.history.back();
    }
  }
// รองรับปุ่ม back (popstate) สำหรับ modal YouTube
window.addEventListener('popstate', function(e) {
  if (ytModalOpen) {
    closeYtModal();
  }
});
  if (!ytModalOpen) return;
  ytModalOpen = false;
  const modal = document.getElementById('ytModal');
  const content = modal.querySelector('.modal-content');
  // คำนวณตำแหน่งปุ่มไอคอนอีกครั้ง (เผื่อ resize)
  const logo = document.getElementById('siteLogo');
  const rect = logo.getBoundingClientRect();
  const centerX = window.innerWidth/2;
  const centerY = window.innerHeight/2;
  const iconX = rect.left + rect.width/2;
  const iconY = rect.top + rect.height/2;
  const dx = iconX - centerX;
  const dy = iconY - centerY;
  content.style.setProperty('--yt-x', dx+'px');
  content.style.setProperty('--yt-y', dy+'px');
  content.classList.remove('yt-show-anim');
  content.classList.add('yt-hide-anim');
  setTimeout(function() {
    modal.style.display = 'none';
    content.classList.remove('yt-hide-anim');
  }, 320);
}
</script>
</body>
</html>
